{"version":3,"file":"src_app_pages_history_history_module_ts.js","mappings":"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","sources":["./src/app/pages/history/history-routing.module.ts","./src/app/pages/history/history.module.ts","./src/app/pages/history/history.page.ts","./src/app/pages/history/history.page.html"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { HistoryPage } from './history.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: HistoryPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class HistoryPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { HistoryPageRoutingModule } from './history-routing.module';\r\nimport { HistoryPage } from './history.page';\r\nimport { SharedTranslationsModule } from '../../shared/shared-translations.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    HistoryPageRoutingModule,\r\n    SharedTranslationsModule\r\n  ],\r\n  declarations: [HistoryPage]\r\n})\r\nexport class HistoryPageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { NavController } from '@ionic/angular';\r\nimport { Firestore, collection, getDocs, query, where, orderBy } from '@angular/fire/firestore';\r\nimport { Auth } from '@angular/fire/auth';\r\nimport { TranslateService } from '@ngx-translate/core';\r\n\r\ninterface TripHistory {\r\n  Rider_name: string;\r\n  Rider_imgUrl: string;\r\n  driverRating: number;\r\n  driverComment?: string;\r\n  time: any;\r\n  earnings: number;\r\n  status: string;\r\n  requestId?: string;\r\n}\r\n\r\ninterface HistoryGroup {\r\n  date: Date;\r\n  trips: TripHistory[];\r\n  totalEarnings: number;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-history',\r\n  templateUrl: './history.page.html',\r\n  styleUrls: ['./history.page.scss'],\r\n})\r\nexport class HistoryPage implements OnInit {\r\n  histories: TripHistory[] = [];\r\n  groupedHistories: HistoryGroup[] = [];\r\n  loading: boolean = true;\r\n  selectedPeriod: string = 'week';\r\n  totalTrips: number = 0;\r\n  averageRating: number = 0;\r\n  totalEarnings: number = 0;\r\n\r\n  constructor(\r\n    private nav: NavController, \r\n    private firestore: Firestore, \r\n    private auth: Auth,\r\n    private translate: TranslateService\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.loadHistory();\r\n  }\r\n\r\n  async loadHistory() {\r\n    try {\r\n      this.loading = true;\r\n      const userId = this.auth.currentUser.uid;\r\n      const historyRef = collection(this.firestore, `Drivers/${userId}/History`);\r\n      \r\n      // Create query based on selected period\r\n      const startDate = this.getStartDate();\r\n      const historyQuery = query(\r\n        historyRef,\r\n        where('time', '>=', startDate),\r\n        orderBy('time', 'desc')\r\n      );\r\n\r\n      const snapshot = await getDocs(historyQuery);\r\n      this.histories = snapshot.docs.map(doc => {\r\n        const data = doc.data() as TripHistory;\r\n        return { ...data };\r\n      });\r\n\r\n      this.processHistoryData();\r\n    } catch (error) {\r\n      console.error('Error fetching history:', error);\r\n    } finally {\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  private getStartDate(): Date {\r\n    const now = new Date();\r\n    switch (this.selectedPeriod) {\r\n      case 'today':\r\n        return new Date(now.setHours(0, 0, 0, 0));\r\n      case 'week':\r\n        const lastWeek = new Date(now);\r\n        lastWeek.setDate(lastWeek.getDate() - 7);\r\n        return lastWeek;\r\n      case 'month':\r\n        const lastMonth = new Date(now);\r\n        lastMonth.setMonth(lastMonth.getMonth() - 1);\r\n        return lastMonth;\r\n      default:\r\n        return new Date(now.setHours(0, 0, 0, 0));\r\n    }\r\n  }\r\n\r\n  private processHistoryData() {\r\n    // Calculate totals\r\n    this.totalTrips = this.histories.length;\r\n    this.totalEarnings = this.histories.reduce((sum, trip) => sum + (trip.earnings || 0), 0);\r\n    \r\n    // Only use driverRating for consistency\r\n    const totalRating = this.histories.reduce((sum, trip) => {\r\n      return sum + (trip.driverRating || 0);\r\n    }, 0);\r\n    \r\n    this.averageRating = this.totalTrips > 0 ? totalRating / this.totalTrips : 0;\r\n\r\n    // Group by date\r\n    const groups = new Map<string, HistoryGroup>();\r\n    \r\n    this.histories.forEach(trip => {\r\n      const date = new Date(trip.time.toDate()).toDateString();\r\n      if (!groups.has(date)) {\r\n        groups.set(date, {\r\n          date: new Date(date),\r\n          trips: [],\r\n          totalEarnings: 0\r\n        });\r\n      }\r\n      const group = groups.get(date);\r\n      group.trips.push(trip);\r\n      group.totalEarnings += trip.earnings || 0;\r\n    });\r\n\r\n    this.groupedHistories = Array.from(groups.values())\r\n      .sort((a, b) => b.date.getTime() - a.date.getTime());\r\n  }\r\n\r\n  filterHistory() {\r\n    this.loadHistory();\r\n  }\r\n}\r\n","<ion-header class=\"ion-no-border\" [translucent]=\"true\">\r\n  <ion-toolbar>\r\n    <ion-buttons slot=\"start\">\r\n      <ion-button color=\"primary\">\r\n        <ion-back-button></ion-back-button>\r\n      </ion-button>\r\n    </ion-buttons>\r\n    <ion-title>{{ 'HISTORY.TITLE' | translate }}</ion-title>\r\n  </ion-toolbar>\r\n\r\n  <!-- Stats Summary Card -->\r\n  <ion-card class=\"stats-card\">\r\n    <ion-grid>\r\n      <ion-row>\r\n        <ion-col>\r\n          <div class=\"stat-item\">\r\n            <h3>{{ totalTrips }}</h3>\r\n            <p>{{ 'HISTORY.TOTAL_TRIPS' | translate }}</p>\r\n          </div>\r\n        </ion-col>\r\n        <ion-col>\r\n          <div class=\"stat-item\">\r\n            <h3>{{ averageRating | number:'1.1-1' }}</h3>\r\n            <p>{{ 'HISTORY.AVG_RATING' | translate }}</p>\r\n          </div>\r\n        </ion-col>\r\n        <ion-col>\r\n          <div class=\"stat-item\">\r\n            <h3>{{ totalEarnings | currency }}</h3>\r\n            <p>{{ 'HISTORY.TOTAL_EARNINGS' | translate }}</p>\r\n          </div>\r\n        </ion-col>\r\n      </ion-row>\r\n    </ion-grid>\r\n  </ion-card>\r\n\r\n  <!-- Date Filter Segment -->\r\n  <ion-segment [(ngModel)]=\"selectedPeriod\" (ionChange)=\"filterHistory()\">\r\n    <ion-segment-button value=\"today\">\r\n      {{ 'HISTORY.TODAY' | translate }}\r\n    </ion-segment-button>\r\n    <ion-segment-button value=\"week\">\r\n      {{ 'HISTORY.THIS_WEEK' | translate }}\r\n    </ion-segment-button>\r\n    <ion-segment-button value=\"month\">\r\n      {{ 'HISTORY.THIS_MONTH' | translate }}\r\n    </ion-segment-button>\r\n  </ion-segment>\r\n</ion-header>\r\n\r\n<ion-content>\r\n  <!-- Skeleton loaders -->\r\n  <ion-list *ngIf=\"loading; else loadedContent\">\r\n    <ion-item *ngFor=\"let item of [1, 2, 3]\">\r\n      <ion-skeleton-text animated style=\"width: 100%; height: 100px;\"></ion-skeleton-text>\r\n    </ion-item>\r\n  </ion-list>\r\n\r\n  <!-- Loaded content -->\r\n  <ng-template #loadedContent>\r\n    <ion-list *ngIf=\"groupedHistories.length > 0; else noData\">\r\n      <div *ngFor=\"let group of groupedHistories\">\r\n        <!-- Date Header -->\r\n        <ion-item-divider sticky=\"true\">\r\n          <ion-label>\r\n            {{ group.date | date:'mediumDate' }}\r\n          </ion-label>\r\n          <ion-note slot=\"end\">\r\n            {{ group.totalEarnings | currency }}\r\n          </ion-note>\r\n        </ion-item-divider>\r\n\r\n        <!-- Trips for the date -->\r\n        <ion-card *ngFor=\"let trip of group.trips\" class=\"trip-card\">\r\n          <ion-card-content>\r\n            <ion-grid>\r\n              <ion-row>\r\n                <ion-col size=\"2\">\r\n                  <ion-avatar>\r\n                    <ion-img [src]=\"trip.Rider_imgUrl || 'assets/imgs/default-avatar.png'\"></ion-img>\r\n                  </ion-avatar>\r\n                </ion-col>\r\n                <ion-col size=\"7\">\r\n                  <h3>{{ trip.Rider_name }}</h3>\r\n                  <p class=\"trip-details\">\r\n                    <ion-icon name=\"time-outline\"></ion-icon>\r\n                    {{ trip.time?.toDate() | date: 'shortTime' }}\r\n                  </p>\r\n                  <p class=\"trip-details\">\r\n                    <ion-icon name=\"star\"></ion-icon>\r\n                    {{ trip.driverRating || 'N/A' }}\r\n                  </p>\r\n                </ion-col>\r\n                <ion-col size=\"3\" class=\"ion-text-end\">\r\n                  <h3 class=\"earnings\">{{ trip.earnings | currency }}</h3>\r\n                  <ion-badge [color]=\"trip.status === 'completed' ? 'success' : 'warning'\">\r\n                    {{ trip.status }}\r\n                  </ion-badge>\r\n                </ion-col>\r\n              </ion-row>\r\n            </ion-grid>\r\n          </ion-card-content>\r\n        </ion-card>\r\n      </div>\r\n    </ion-list>\r\n  </ng-template>\r\n\r\n  <!-- No Data Template -->\r\n  <ng-template #noData>\r\n    <div class=\"empty-state\">\r\n      <ion-img src=\"../assets/imgs/empty.svg\"></ion-img>\r\n      <h2>{{ 'HISTORY.NO_DATA' | translate }}</h2>\r\n      <p>{{ 'HISTORY.BOOK_RIDE' | translate }}</p>\r\n    </div>\r\n  </ng-template>\r\n</ion-content>\r\n"],"names":["collection","getDocs","query","where","orderBy","i0","_r3","HistoryPage","constructor","nav","firestore","auth","translate","ngOnInit","loadHistory","loading","userId","currentUser","uid","historyRef","startDate","getStartDate","historyQuery","snapshot","histories","docs","map","doc","data","processHistoryData","error","console","now","Date","selectedPeriod","setHours","lastWeek","setDate","getDate","lastMonth","setMonth","getMonth","totalTrips","length","totalEarnings","reduce","sum","trip","earnings","totalRating","driverRating","averageRating","groups","Map","forEach","date","time","toDate","toDateString","has","set","trips","group","get","push","groupedHistories","Array","from","values","sort","a","b","getTime","filterHistory","selectors","decls","vars","consts","template","ctx","_r1"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}